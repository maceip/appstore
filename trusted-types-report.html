
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trusted Types Security Report</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        .metric-label {
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .section {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .violation {
            background: #fff5f5;
            border-left: 4px solid #e53e3e;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .violation.critical { border-left-color: #c53030; background: #fed7d7; }
        .violation.high { border-left-color: #e53e3e; background: #fff5f5; }
        .violation.medium { border-left-color: #ed8936; background: #fffaf0; }
        .policy {
            background: #f0fff4;
            border-left: 4px solid #38a169;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .recommendation {
            background: #ebf8ff;
            border-left: 4px solid #3182ce;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .code {
            background: #f7fafc;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        .security-score {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            padding: 20px;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        .score-excellent { background: #c6f6d5; color: #22543d; }
        .score-good { background: #fef5e7; color: #744210; }
        .score-poor { background: #fed7d7; color: #742a2a; }
        .timestamp {
            color: #666;
            font-size: 0.9rem;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ°Ô∏è Trusted Types Security Report</h1>
        <p>Comprehensive analysis of Trusted Types implementation and security posture</p>
    </div>

    <div class="summary">
        <div class="metric">
            <div class="metric-value">26</div>
            <div class="metric-label">Files Analyzed</div>
        </div>
        <div class="metric">
            <div class="metric-value">1</div>
            <div class="metric-label">Files with TT</div>
        </div>
        <div class="metric">
            <div class="metric-value">2</div>
            <div class="metric-label">Policies Found</div>
        </div>
        <div class="metric">
            <div class="metric-value">12</div>
            <div class="metric-label">Issues Found</div>
        </div>
    </div>

    <div class="section">
        <h2>üîí Security Score</h2>
        <div class="security-score score-good">
            61/100
        </div>
        <p style="text-align: center; margin-top: 15px;">
            Moderate security - several issues should be addressed
        </p>
    </div>

    
    <div class="section">
        <h2>üìã Trusted Types Policies</h2>
        
            <div class="policy">
                <h3>iwa-sanitizer</h3>
                <p><strong>File:</strong> src/main.ts:30</p>
                <p><strong>Security Level:</strong> 100/100</p>
                <p><strong>Methods:</strong> createHTML</p>
            </div>
        
            <div class="policy">
                <h3>iwa-url-policy</h3>
                <p><strong>File:</strong> src/main.ts:36</p>
                <p><strong>Security Level:</strong> 80/100</p>
                <p><strong>Methods:</strong> createScriptURL</p>
            </div>
        
    </div>
    

    
    <div class="section">
        <h2>üö® Security Violations</h2>
        
            <div class="violation critical">
                <h3>eval usage (CRITICAL)</h3>
                <p><strong>File:</strong> src/kotlin-js-rag-functions.js:392</p>
                <p><strong>Code:</strong></p>
                <div class="code">eval(</div>
                <details><summary>Context</summary><pre class="code">    391:             
>>> 392:             const result = eval(sanitizedExpression);
    393:             </pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/main.ts:69</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = `
        <option value="basic">Basic HTTP Server (Port 44818)</option>
        <option value="enhanced">Enhanced HTTP Server (Port 44818)</option>
        <option value="tls">TLS/HTTPS Server (Port 44819)</option>
    `</div>
                <details><summary>Context</summary><pre class="code">    68:     modeSelect.style.cssText = "padding: 5px 10px; border-radius: 4px; border: 1px solid #ccc;";
>>> 69:     modeSelect.innerHTML = `
    70:         <option value="basic">Basic HTTP Server (Port 44818)</option></pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/main.ts:150</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = sanitizerPolicy.createHTML(`
            <strong>Server Details:</strong><br>
            ‚Ä¢ Mode: ${mode.toUpperCase()}<br>
            ‚Ä¢ Host: 0.0.0.0<br>
            ‚Ä¢ Port: ${port}<br>
            ‚Ä¢ Access: <code>${protocol}://localhost:${port}</code><br>
            ‚Ä¢ Features: ${features[mode].join(', ')}
        `)</div>
                <details><summary>Context</summary><pre class="code">    149: 
>>> 150:         info.innerHTML = sanitizerPolicy.createHTML(`
    151:             <strong>Server Details:</strong><br></pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/main.ts:243</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = sanitizerPolicy.createHTML("")</div>
                <details><summary>Context</summary><pre class="code">    242: function loadOnlineContent() {
>>> 243:     parent_container.innerHTML = sanitizerPolicy.createHTML("");
    244: </pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/main.ts:291</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = sanitizerPolicy.createHTML("")</div>
                <details><summary>Context</summary><pre class="code">    290: function showOfflineMessage() {
>>> 291:     parent_container.innerHTML = sanitizerPolicy.createHTML("");
    292:     const p_offline = document.createElement("p");</pre></details>
            </div>
        
            <div class="violation critical">
                <h3>eval usage (CRITICAL)</h3>
                <p><strong>File:</strong> src/phase5-ai-ml-integration.ts:323</p>
                <p><strong>Code:</strong></p>
                <div class="code">eval(</div>
                <details><summary>Context</summary><pre class="code">    322:                 // Simple expression evaluation (in real implementation, use safe evaluator)
>>> 323:                 const result = eval(args.expression.replace(/[^0-9+\-*/().\s]/g, ''));
    324:                 return {</pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/server.ts:244</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = '<div class="info">Output cleared</div>'</div>
                <details><summary>Context</summary><pre class="code">    243:           function clearOutput() {
>>> 244:             document.getElementById('output').innerHTML = '<div class="info">Output cleared</div>';
    245:           }</pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/server.ts:418</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = '‚úÖ AI/ML System Ready'</div>
                <details><summary>Context</summary><pre class="code">    417:                 statusEl.className += ' ai-ready';
>>> 418:                 statusEl.innerHTML = '‚úÖ AI/ML System Ready';
    419:                 break;</pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/server.ts:422</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = '‚ùå AI/ML System Error'</div>
                <details><summary>Context</summary><pre class="code">    421:                 statusEl.className += ' ai-error';
>>> 422:                 statusEl.innerHTML = '‚ùå AI/ML System Error';
    423:                 break;</pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/server.ts:426</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = 'üîÑ AI/ML System Initializing...'</div>
                <details><summary>Context</summary><pre class="code">    425:                 statusEl.className += ' ai-initializing';
>>> 426:                 statusEl.innerHTML = 'üîÑ AI/ML System Initializing...';
    427:             }</pre></details>
            </div>
        
            <div class="violation high">
                <h3>innerHTML without policy (HIGH)</h3>
                <p><strong>File:</strong> src/server.ts:623</p>
                <p><strong>Code:</strong></p>
                <div class="code">.innerHTML = '<h3>IWA Info</h3><p>Bundle ID: ${bundleId}</p><p>Generated: ' + new Date().toISOString() + '</p>'</div>
                <details><summary>Context</summary><pre class="code">    622:           const info = document.createElement('div');
>>> 623:           info.innerHTML = '<h3>IWA Info</h3><p>Bundle ID: ${bundleId}</p><p>Generated: ' + new Date().toISOString() + '</p>';
    624:           document.body.appendChild(info);</pre></details>
            </div>
        
            <div class="violation critical">
                <h3>eval usage (CRITICAL)</h3>
                <p><strong>File:</strong> vite-iwa-template/src/kotlin-js-rag-functions.js:604</p>
                <p><strong>Code:</strong></p>
                <div class="code">eval(</div>
                <details><summary>Context</summary><pre class="code">    603:         // Simple calculator (in production, use a safe math parser)
>>> 604:         const result = eval(expression.replace(/[^0-9+\-*/().\s]/g, ''));
    605:         return { expression, result };</pre></details>
            </div>
        
    </div>
    

    
    <div class="section">
        <h2>üí° Recommendations</h2>
        
            <div class="recommendation">
                <h3>[CRITICAL] Fix Critical Security Issues</h3>
                <p>Critical security violations found (eval, Function constructor).</p>
                <p><strong>Action:</strong> Remove or replace dangerous code patterns immediately</p>
            </div>
        
            <div class="recommendation">
                <h3>[HIGH] Secure DOM Manipulation</h3>
                <p>Direct innerHTML assignments found without Trusted Types.</p>
                <p><strong>Action:</strong> Use sanitizerPolicy.createHTML() for all HTML content</p>
            </div>
        
            <div class="recommendation">
                <h3>[MEDIUM] Increase Trusted Types Coverage</h3>
                <p>Less than 50% of files use Trusted Types.</p>
                <p><strong>Action:</strong> Extend Trusted Types usage to more files handling dynamic content</p>
            </div>
        
    </div>
    

    <div class="timestamp">
        Report generated on 8/13/2025, 3:38:40 PM
    </div>
</body>
</html>
  